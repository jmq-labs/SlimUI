function go(e){$.when($(".MENU_LIST").hide("fade",100)).done(function(){var t="",n="config/system/master.php?uqid="+UQID+"&page=../";$("#MAIN"+CurrentFrame).attr("folder")&&(t=$("#MAIN"+CurrentFrame).attr("folder"));var i=n+t;$("#MAIN"+CurrentFrame).attr("isasp")&&(e+="&asp=true"),$("#MAIN"+CurrentFrame).attr("safeMode")&&$("#MAIN"+CurrentFrame).attr("isasp")?$("#MAIN"+CurrentFrame).attr("src",t.substr(3)+e.replace("&asp=true","")):$("#MAIN"+CurrentFrame).attr("src",i+e),parent.eLog("Menu navigation handler","URL : "+e)})}function setSession(e,t){if(t){var n=function(){var e=new Array;return $.ajax({type:"GET",url:"config/api.php",dataType:"json",cache:!1,data:{userinfo:"true",uqid:UQID},async:!1,success:function(t){e[0]=t}}),$.ajax({type:"GET",url:"config/api.php",dataType:"json",cache:!1,data:{cookiedata:"true",uqid:UQID},async:!1,success:function(t){e[1]=t}}),{getUserInfo:function(){return e[0]?e[0]:!1},getCookieOptions:function(){return e[1]?e[1]:!1}}}();activeUsr=e,displayName=activeUsr,FILTER_BY&&(_key=$(n.getUserInfo())[0][FILTER_BY]);var a="<img class='USER_PROFILE_IMG' src='content/themes/"+THEME+"/img/profile-picture.png' /><div class='SEPARATOR'></div>",o="<div><label id='USER_NAME' ></label><br /><a id='SESSION_OFF'>"+LANG_MAIN_CLOSESESSION+"</a></div>";for("MOBILE"==DEVICE_TYPE?activeUsr.length>20&&(displayName=displayName.substr(0,20)+"..."):activeUsr.length>35&&(displayName=displayName.substr(0,35)+"..."),$("#USER_SESSION_DATA").html(a+o),$("#USER_NAME").html(displayName),$("#WM_LOGO").attr("src","content/img/home.png"),$("#WM_LOGO_DROPMENU").show("fade",150),$(".SEPARATOR").show("fade",150),$(".USER_PROFILE").show("fade",150,function(){$("#WM_LOGO_DROPMENU").click(function(){$("#WIDGET_MENU").toggle("blind",150)}),$("#WM_LOGO").click(function(){MainMenu()}),MainMenu()}),$("#SESSION_OFF").click(function(){SlimAlert(LANG_MAIN_CLOSESESSIONMSG,function(){LogOff()})}),$("#WIDGET_MENU").load("config/appsmenu.php?uqid="+UQID,function(){$("#MAIN_MENU").SlimMenu(),$(".WIDGET_BUTTON").SlimButton("Big"),$(".FRAME").SlimFrame(),$(".INPUT_BUTTON").SlimButton(),$("#WIDGET_MENU ._WIDGET_BUTTON").click(function(e){e.stopPropagation(),$("#WIDGET_MENU").hide("blind",150),$("#WIDGET_MENU").promise().done(function(){NewDOM(e.target,WHid++)})})}),i=0;i<$(n.getCookieOptions()).length;i++)cookie_data+=$(n.getUserInfo())[0][$(n.getCookieOptions())[i][0]]+";";setCookie("slimtoken",cookie_data.slice(0,-1),1),parent.eLog("Login event","Navegador: "+browserName+" Ver. "+majorVersion),$.get("http://ipinfo.io",function(e){parent.eLog("Client Ip address",e.ip)},"jsonp")}else window.location="index.php"}function ClearMenu(){$("#MENU_CONTAINER").removeClass("_MENU"),$("#MENU_CONTAINER").addClass("MENU"),$("#MENU_CONTAINER").html("")}function LogOff(){document.location.href=WWWROOT+"?kill_session=true"}function ShowDOM(e,t){function n(e,t){var n=document.createElement("script");n.type="text/javascript",n.readyState?n.onreadystatechange=function(){("loaded"==n.readyState||"complete"==n.readyState)&&(n.onreadystatechange=null,t())}:n.onload=function(){t()},n.src=e,$("#MAIN"+CurrentFrame).contents().find("head")[0].appendChild(n)}"MOBILE"==DEVICE_TYPE&&$(".MAIN").hide(),CurrentFrame=$(e).attr("pid"),$(".MAIN_DIV").css("height",window.innerHeight-$("#MAIN_MENU").outerHeight()),1==t&&$(e).attr("isasp")&&($.get("config/system/master.php?getheaders=true&uqid="+UQID,function(e){$("#MAIN"+CurrentFrame).contents().find("head").append(e)}),$("#MAIN"+CurrentFrame).contents().find("body").hide(),n(WWWROOT+"content/scripts/jquery/jquery-1.11.2.min.js",function(){n(WWWROOT+"content/scripts/jquery/jquery-ui.min.js",function(){n(WWWROOT+"content/scripts/slim-ui-1.0.min.js",function(){n(WWWROOT+"content/plugins/timepicker/jquery-ui-timepicker.js",function(){n(WWWROOT+"content/plugins/mask/qunit-1.11.0.js",function(){n(WWWROOT+"content/plugins/mask/jquery.mask.js",function(){n(WWWROOT+"content/scripts/safemode.js",function(){$("#MAIN"+CurrentFrame).contents().find("body").show()})})})})})})})),$(e).attr("appmenu")&&$("#MENU_CONTAINER").is(":empty")&&(ClearMenu(),$("#MENU_CONTAINER").load($(e).attr("appmenu"),function(){$.ajax({type:"GET",url:WWWROOT+$(e).attr("folder").substr(3)+"appid.xml",dataType:"xml",cache:!1,success:function(e){var t=$("display_menu_filters",e).children().length,n=$("display_menu_filters",e).children();for(i=0;i<t;i++){var a=n[i].childNodes[0].data.split(",");-1==a.indexOf(_key)?$("#"+n.get(i).tagName).remove():$("#"+n.get(i).tagName).show()}}})})),$(e).show("fade",150),$(e).css("z-index",1)}function NewDOM(e,t,n){var i=$(e).attr("url")+"&uqid="+UQID;if(n||(_safeMode&&(n=!0),$(e).attr("safemode")&&(n=!0)),1==n&&$(e).attr("isasp")&&(i=$(e).attr("url").substr("36").replace("&asp=true","")),"LABEL"!=e.tagName){if(t){var a=$("<iframe/>",{id:"MAIN"+t,uqid:UQID,Class:"MAIN MAIN_DIV",pid:t,appname:$(e).attr("appname"),src:i,onload_src:$(e).attr("onload_src"),isasp:$(e).attr("isasp"),folder:$(e).attr("folder"),safemode:n,appmenu:$(e).attr("appmenu"),style:"display:none",load:function(){ShowDOM(this,n)}});$("#MAIN_CONTAINER").append(a),HistoryWidget(t,$(e).attr("title"),$(e).attr("icon"),$(e).attr("color"),$(e).attr("appmenu")),$(".HISTORY_WIDGET").hide()}ClearMenu()}else $(e).parent().trigger("click")}function MainMenu(){$(".MAIN").hide("fade",150,function(){$(".HISTORY_WIDGET").each(function(){if($(this).hasClass("NEW")){var e=$(this).attr("pid");$(this).show().animate({display:"inline-block",opacity:1,marginLeft:"+=25"},200),$(this).children(".HWIDGET_REMOVE").click(function(t){t.stopPropagation(),$(this).parent(".HISTORY_WIDGET").animate({display:"block",opacity:0,marginLeft:"-=200"},200,function(){$(".MAIN").each(function(){$(this).attr("pid")==e&&"MAIN"!=$(this).attr("id")&&$(this).remove()}),$(this).remove()})}),$(this).unbind("click"),$(this).click(function(){CurrentFrame=e,$(".HISTORY_WIDGET").hide(),$(".MAIN").hide(),$("#MAIN"+e).show("fade",150),$("#MAIN"+e).attr("appmenu")&&$("#MENU_CONTAINER").load($("#MAIN"+e).attr("appmenu"),function(){$.ajax({type:"GET",url:WWWROOT+$("#MAIN"+e).attr("folder").substr(3)+"appid.xml",dataType:"xml",success:function(e){var t=$("display_menu_filters",e).children().length,n=$("display_menu_filters",e).children();for(i=0;i<t;i++){var a=n[i].childNodes[0].data.split(",");-1==a.indexOf(_key)?$("#"+n.get(i).tagName).remove():$("#"+n.get(i).tagName).show()}}})}),parent.eLog("Interface handler","Open widget : "+$(this).attr("title"))}),$(this).mouseenter(function(){}),$(this).mouseleave(function(){}),$(this).removeClass("NEW")}else $(".HISTORY_WIDGET").show()})}),parent.eLog("Interface handler","Show desktop"),ClearMenu()}function HistoryWidget(e,t,n,i){var a="";$("#HISTORY_WIDGETS").append("<div id='HW_"+e+"' pid='"+e+"' class='WIDGET_BUTTON HISTORY_WIDGET NEW' title='"+t+"' icon='"+n+"' color='"+i+"' ><img src='content/img/clock.png' /><label class='HWIDGET_PID'>"+a+"</label><div class='HWIDGET_REMOVE _VOID'><img src='content/img/widget-close.png' /></div></div>"),$(".WIDGET_BUTTON").SlimButton("Big")}function setCookie(e,t,n){eraseCookie(e);var i=new Date;i.setDate(i.getDate()+n);var a=escape(t)+(null==n?"":"; expires="+i.toUTCString());document.cookie=e+"="+a}function getCookie(e){var t=document.cookie,n=t.indexOf(" "+e+"=");if(-1==n&&(n=t.indexOf(e+"=")),-1==n)t=null;else{n=t.indexOf("=",n)+1;var i=t.indexOf(";",n);-1==i&&(i=t.length),t=unescape(t.substring(n,i))}return t}function checkCookie(e){var e=getCookie(e);return null!=e&&""!=e?!0:!1}function eraseCookie(e){document.cookie=e+"=; Max-Age=0"}function HideMenu(e){$("#"+e).hide()}function ShowMenu(e){$("#"+e).show()}function ConfirmAsp(e,t){return 0==_confirmCallback&&parent.SlimAlert(e,function(){_confirmCallback=!0,$.when($(t).trigger("click")).then(function(){_confirmCallback=!1})}),_confirmCallback}var WHid=1,activeUsr="",CurrentFrame=0,_safeMode,_key,_confirmCallback=!1,cookie_data="",loginFrame="<iframe id='MAIN0' class='MAIN MAIN_DIV' pid='0' onload='ShowDOM(this)' src='config/system/master.php?uqid="+UQID+"&page=login.php&auth=true' ></iframe>";$(function(){function e(){parent.eLog("Window event","Close")}$("body").append(loginFrame),$("#MAIN_MENU").show().animate({display:"block",opacity:1,marginLeft:"+=25"},200),$(window).bind("hashchange",function(){parent.window.location(WWWROOT)}),"x-mas"==THEME&&$.getScript("content/themes/x-mas/snow.js");var t="<p><a href='http://www.google.com/intl/en/chrome/browser/'><img  style='border:none;' src='content/img/chromelogo.png' /></a></p>";-1==browserName.indexOf("Chrome")&&-1==browserName.indexOf("Safari")&&-1==browserName.indexOf("Mobile")&&(SlimAlert(LANG_LOGIN_BROWSER_COMP+t),_safeMode=!0),window.navigator.standalone&&$("body").css("padding-top","20px"),$.ajaxSetup({cache:AJAX_CACHE===!0?!0:!1}),$(document).ajaxStart(function(){$("#PROGRESS").length<1&&($("body").prepend("<div id='PROGRESS'></div>"),$("#PROGRESS").delay(1e3).show("fade"))}),$(document).ajaxSuccess(function(){$("#PROGRESS").remove(),$("#MENU_CONTAINER").SlimMenu()}),$(document).ajaxError(function(){}),$("img, div, label, xmp").click(function(e){var t=$(e.target);t.hasClass("_VOID")||t.hasClass("METAEDITABLE")||(parent.$(".MENU_LIST").hide("fade",100),parent.$("#WIDGET_MENU").hide("blind",150),$(".TASKWIDGET").remove())}),window.onbeforeunload=e});